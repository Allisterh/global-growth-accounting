dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit()
solow %>%
select(region, year, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region, year)) %>%
ggplot(aes(year, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 15)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
# Solow decomposition
solow_regions <-
regions %>%
group_by(region) %>%
mutate(
# Logs of output, capital and labor
y = log(y),
k = log(k),
l = log(l),
# First differences (growth rates)
dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit()
solow_regions
# Solow decomposition
solow_regions <-
regions %>%
group_by(region) %>%
mutate(
# Logs of output, capital and labor
y = log(y),
k = log(k),
l = log(l),
# First differences (growth rates)
dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit() %>%
select(region, k_cont, y_cont, tfp_cont) %>%
summarise_if(is.numeric, mean)
solow_regions
# Solow decomposition
solow_regions <-
regions %>%
group_by(region) %>%
mutate(
# Logs of output, capital and labor
y = log(y),
k = log(k),
l = log(l),
# First differences (growth rates)
dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit() %>%
select(region, k_cont, l_cont, tfp_cont) %>%
summarise_if(is.numeric, mean)
solow_regions
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region))
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 15)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col()
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 10)) +
scale_x_discrete(breaks = scales::pretty_breaks(n = 15)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 10)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 5)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento a nivel mundial",
subtitle = "Contribución de los factores productivos (1985 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 5)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
ggsave(filename = here("Plots","Plot3.png"))
regions
solow_regions
regions %>%
group_by(region)
# Solow decomposition
solow_regions <-
regions %>%
group_by(region) %>%
filter(year %in% c(1999:2019)) %>%
mutate(
# Logs of output, capital and labor
y = log(y),
k = log(k),
l = log(l),
# First differences (growth rates)
dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit() %>%
select(region, k_cont, l_cont, tfp_cont) %>%
summarise_if(is.numeric, mean)
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento a nivel mundial",
subtitle = "Contribución de los factores productivos (1985 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 5)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
# Solow decomposition
solow_regions <-
regions %>%
group_by(region) %>%
filter(year %in% c(1984:2019)) %>%
mutate(
# Logs of output, capital and labor
y = log(y),
k = log(k),
l = log(l),
# First differences (growth rates)
dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit() %>%
select(region, k_cont, l_cont, tfp_cont) %>%
summarise_if(is.numeric, mean)
solow_regions %>%
select(region, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(region)) %>%
ggplot(aes(region, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento a nivel mundial",
subtitle = "Contribución de los factores productivos (1985 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 5)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
regions %>%
group_by(region) %>%
filter(year %in% c(1984:2019))
ggsave(filename = here("Plots","Plot3.png"))
data_raw
countries
write_csv(countries, "countries.csv")
countries <- read_csv("countries.csv")
gtm
gtm
solow <- function(data, region, y, l, k, labsh) {
data %>%
mutate(
# Logs of output, capital and labor
y = log({{y}}),
k = log({{k}}),
l = log({{l}}))
}
solow(gtm)
solow(gtm, y = y, l = l, k = k)
solow <- function(data, region, y, l, k, labsh) {
data %>%
mutate(
# Logs of output, capital and labor
y = log({{y}}),
k = log({{k}}),
l = log({{l}}),
# First differences (growth rates)
dy = ({{y}} - lag({{y}})) * 100,
dk = ({{k}} - lag({{k}})) * 100,
dl = ({{l}} - lag({{l}})) * 100,
# Share of capital in the economy
capsh = 1 - {{labsh}},
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * {{labsh}},
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit()
}
solow(gtm, y = y, l = l, k = k)
solow(gtm, y = y, l = l, k = k, labsh = labsh)
s_gtm <- solow(gtm, y = y, l = l, k = k, labsh = labsh)
# Solow decomposition
solow_gtm <-
gtm %>%
mutate(
# Logs of output, capital and labor
y = log(y),
k = log(k),
l = log(l),
# First differences (growth rates)
dy = (y - lag(y)) * 100,
dk = (k - lag(k)) * 100,
dl = (l - lag(l)) * 100,
# Share of capital in the economy
capsh = 1 - labsh,
# Contributions of factors in the output growth
k_cont = dk * capsh,
l_cont = dl * labsh,
tfp_cont = dy - k_cont - l_cont
) %>%
na.omit()
s_gtm %>%
select(country, year, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(country, year)) %>%
ggplot(aes(year, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento: Guatemala",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 15)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
solow_gtm %>%
select(country, year, k_cont, l_cont, tfp_cont) %>%
pivot_longer(-c(country, year)) %>%
ggplot(aes(year, value, fill = name)) +
geom_col() +
labs(title = "Contabilidad del crecimiento: Guatemala",
subtitle = "Contribución de los factores productivos (1955 – 2019)",
caption = "Datos: Penn World Table (v 10.0)") +
guides(color = guide_legend(nrow = 1)) +
scale_fill_discrete(name = "Contribución:",
labels = c("Capital", "Trabajo", "PTF")) +
scale_y_continuous(labels = comma, breaks = scales::pretty_breaks(n = 10)) +
scale_x_continuous(breaks = scales::pretty_breaks(n = 15)) +
guides(color = guide_legend(nrow = 1)) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
plot.title = element_text(
face = "bold",
hjust = .5,
margin = margin(10, 0, 5, 0)
),
plot.subtitle = element_text(hjust = .5,
margin = margin(0, 0, 15, 0)),
plot.caption = element_text(color = "gray50",
size = 8,
margin = margin(15, 0, 0, 0)),
legend.position = "bottom",
legend.title = element_blank(),
panel.background = element_rect(fill = "gray95")
)
gtm %>%
solow()
