```{r}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(tidyverse, magrittr)
```

# Relation between extreme poverty rate and capital, labor and technology contributions to economic growth

```{r}
poverty <- read_csv("poverty.csv")
regions <- read_csv("regions.csv")
```

```{r}
solow <- function(data, y, l, k, labsh) {
  data %>%
  mutate(
    # Logs of output, capital and labor
    y = log({{y}}),
    k = log({{k}}),
    l = log({{l}}),
    # First differences (growth rates)
    dy = ({{y}} - lag({{y}})) * 100,
    dk = ({{k}} - lag({{k}})) * 100,
    dl = ({{l}} - lag({{l}})) * 100,
    # Share of capital in the economy
    capsh = 1 - {{labsh}},
    # Contributions of factors in the output growth
    k_cont = dk * capsh,
    l_cont = dl * {{labsh}},
    tfp_cont = dy - k_cont - l_cont
  ) %>%
  na.omit()
}
```

```{r}
# Solow decomposition by region
regions_solow <- 
  regions %>%
  group_by(region) %>%
  filter(year %in% c(1984:2019)) %>%
  solow(y = y,
        l = l,
        k = k,
        labsh = labsh) %>%
  select(region, year, k_cont, l_cont, tfp_cont)

# Poverty rate of change by region
poverty_rateofchange <- 
  poverty %>% 
  mutate(pov = ((pov - lag(pov)) / lag(pov) * 100)) %>% 
  na.omit()

# Join dataframes
join <- 
  regions_solow %>% 
  left_join(poverty_rateofchange) %>% 
  select(region:tfp_cont, pov) %>% 
  ungroup()
```

```{r}
library(panelr)
library(plm)
library(broom)
library(kableExtra)
library(stargazer)

# Declare it as panel data
panel  <-  panel_data(join, id = region, wave = year)

# Model 1: Pooled OLS
pooled <- plm(pov ~ k_cont + l_cont + tfp_cont, 
             data = panel,
             model = "pooling")

pooled %>% tidy()

stargazer(pooled, type = "text")
```

```{r}
# Model 2: Random effects
random <- plm(pov ~ k_cont + l_cont + tfp_cont, 
             data = panel,
             model = "random")

summary(random)

# Model 3: Fixed effects
fixed <- plm(pov ~ k_cont + l_cont + tfp_cont, 
             data = panel,
             model = "fd")

summary(fixed)
```
